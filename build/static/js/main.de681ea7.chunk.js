(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(10),a=n.n(c),s=n(19),i=n(35),u=n(7),o=n.n(u),j=n(14),l=n(26),b=n.n(l),d="/api/blogs",O=null,h=null,p=function(){var e=Object(j.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(j.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(j.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(d,"/").concat(t.id),e.next=3,b.a.put(n,t,h);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(j.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(d,"/").concat(t.id),e.next=3,b.a.delete(n,h);case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g={getAll:function(){return b.a.get(d,h).then((function(e){return e.data}))},login:p,setToken:function(e){e?(O="bearer ".concat(e),h={headers:{Authorization:O}}):O=null},create:function(){var e=Object(j.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(i.a)(Object(i.a)({},t),{},{likes:0}),console.log(t),console.log(h),e.next=5,b.a.post(d,t,h);case 5:return n=e.sent,e.abrupt("return",n.data);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:x,deleteBlog:v,register:f},m=n(15),y=function(e){return function(){var t=Object(j.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.deleteBlog(e);case 2:204===t.sent.status&&n({type:"DELETE_BLOG",id:e.id});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":return e.concat(t.data);case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.id}));default:return e}},E=n(16),S=n(23),k=n(135),T=n(106),R=n(139),L=n(140),N=n(141),C=n(142),G=function(e){return{type:"NEW_NOTIF",data:e}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_NOTIF":return t.data;case"RESET":return null;default:return e}},D=n(2),_=function(){var e=Object(E.h)().id,t=Object(m.c)((function(e){return e.blogs})),n=Object(r.useState)(null),c=Object(s.a)(n,2),a=c[0],u=c[1],l=Object(m.b)(),b=Object(E.g)(),d=t.find((function(t){return t.id===e})),O=Object(m.c)((function(e){return e.user}));if(Object(r.useEffect)((function(){d&&u(d.likes)}),[]),!d)return b.push("/blogs"),null;var h=function(){var e=Object(j.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.confirm("Remove blog '".concat(d.title,"' by ").concat(d.author,"?"))&&(l(y(d)),l(G({type:"success",message:"DELETED POST"})),b.push("/blogs"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(j.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(t=a+1),n=Object(i.a)(Object(i.a)({},d),{},{likes:t}),e.next=5,g.update(n);case 5:r=e.sent,console.log(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f={display:O&&d.user&&O.username===d.user.username?"":"none"};return Object(D.jsxs)("div",{children:[Object(D.jsxs)("h2",{children:[d.title," by ",d.author," "]}),Object(D.jsx)("p",{children:Object(D.jsx)("a",{href:d.url,children:d.url})}),Object(D.jsxs)("p",{children:["likes ".concat(a),Object(D.jsx)("button",{onClick:p,children:"like"})]}),Object(D.jsx)("p",{style:f,children:Object(D.jsx)("button",{onClick:h,children:"remove"})})]})},B=function(){var e=Object(m.c)((function(e){return e.blogs})),t=Object(m.c)((function(e){return e.message})),n=Object(m.b)();return t&&setTimeout((function(){n({type:"RESET"})}),3e3),Object(D.jsxs)("div",{children:[Object(D.jsx)("h2",{children:"Blogs"}),Object(D.jsx)(k.a,{component:T.a,children:Object(D.jsx)(R.a,{children:Object(D.jsx)(L.a,{children:e.map((function(e){return Object(D.jsxs)(N.a,{children:[Object(D.jsx)(C.a,{children:Object(D.jsx)(S.b,{to:"/blogs/".concat(e.id),children:e.title})}),Object(D.jsxs)(C.a,{children:["by ",e.author]})]},e.id)}))})})})]})},A={getAll:function(){var e=Object(j.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},W=function(e){return function(){var t=Object(j.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.localStorage.setItem("user",JSON.stringify(e)),n({type:"NEW_USER",data:e});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_USER":case"LOG_USER":return t.data;case"LOGOUT":return null;default:return e}},J=n(148),F=n(143),P=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),i=Object(s.a)(a,2),u=i[0],l=i[1],b=Object(m.b)(),d=Object(E.g)(),O=function(){var e=Object(j.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,g.login({username:n,password:u});case 4:r=e.sent,b(W(r)),b(G({type:"success",message:"LOGGED IN"})),g.setToken(r.token),d.push("/blogs"),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(1),console.log("WRONG LOGIN CREDS  "),b(G({type:"error",message:"WRONG LOGIN CREDS"})),setTimeout((function(){b({type:"RESET"})}),3e3);case 16:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)("div",{children:[Object(D.jsx)("h2",{children:"Log in to application"}),Object(D.jsxs)("form",{onSubmit:O,children:[Object(D.jsx)("div",{children:Object(D.jsx)(J.a,{label:"username",value:n,name:"username",onChange:function(e){return c(e.target.value)}})}),Object(D.jsx)("div",{children:Object(D.jsx)(J.a,{label:"password",type:"password",value:u,name:"password",onChange:function(e){return l(e.target.value)}})}),Object(D.jsx)("br",{}),Object(D.jsx)(F.a,{variant:"contained",type:"submit",children:"login"})]})]})},z=function(e){var t=Object(r.useState)(!1),n=Object(s.a)(t,2),c=n[0],a=n[1],i={display:c?"none":""},u={display:c?"":"none"},o=function(){return a(!c)};return Object(D.jsxs)("div",{children:[Object(D.jsx)("div",{style:i,children:Object(D.jsx)(F.a,{variant:"contained",color:"primary",onClick:o,children:"create new blog"})}),Object(D.jsxs)("div",{style:u,children:[e.children,Object(D.jsx)(F.a,{variant:"contained",color:"secondary",onClick:o,children:"cancel"})]})]})},H=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),i=Object(s.a)(a,2),u=i[0],l=i[1],b=Object(r.useState)(""),d=Object(s.a)(b,2),O=d[0],h=d[1],p=Object(m.b)(),f=Object(m.c)((function(e){return e.user})),x=function(e){p(function(e){return{type:"NEW_BLOG",data:e}}(e)),p(G({type:"success",message:"".concat(f.name," posted ").concat(e.title)})),setTimeout((function(){return p({type:"RESET"})}),3e3)},v=function(){var e=Object(j.a)(o.a.mark((function e(t){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r={title:n,author:u,url:O},e.next=4,g.create(r);case 4:a=e.sent,console.log(a),x(a),c(""),l(""),h("");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)("div",{children:[Object(D.jsx)("h2",{children:"create new"}),Object(D.jsxs)("form",{onSubmit:v,children:[Object(D.jsx)("div",{children:Object(D.jsx)(J.a,{label:"title",value:n,onChange:function(e){var t=e.target;return c(t.value)}})}),Object(D.jsx)("div",{children:Object(D.jsx)(J.a,{label:"author",value:u,onChange:function(e){var t=e.target;return l(t.value)}})}),Object(D.jsx)("div",{children:Object(D.jsx)(J.a,{label:"url",value:O,onChange:function(e){var t=e.target;return h(t.value)}})}),Object(D.jsx)("br",{}),Object(D.jsx)(F.a,{variant:"contained",color:"primary",type:"submit",children:"create"})]})]})},M=n(149),q=function(){var e=Object(m.c)((function(e){return e.message}));if(e){var t="error"===e.type?"error":"success";return Object(D.jsx)("div",{className:e.type,children:Object(D.jsx)(M.a,{severity:t,children:e.message})})}return Object(D.jsx)("div",{})},K=n(144),Q=n(145),V=n(146),X=n(147),Y=function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(""),i=Object(s.a)(a,2),u=i[0],l=i[1],b=Object(r.useState)(""),d=Object(s.a)(b,2),O=d[0],h=d[1],p=Object(m.b)(),f=Object(E.g)(),x=function(){var e=Object(j.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,g.register({username:n,name:u,password:O});case 4:p(G({type:"success",message:"REGISTERED"})),f.push("/login"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),p(G({type:"error",message:"PASSWORD MUST BE AT LEAST 3 CHARACTERS"})),setTimeout((function(){p({type:"RESET"})}),3e3);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)("div",{children:[Object(D.jsx)("h2",{children:"Register"}),Object(D.jsxs)("form",{onSubmit:x,children:[Object(D.jsx)("div",{children:Object(D.jsx)(J.a,{label:"username",value:n,name:"username",onChange:function(e){return c(e.target.value)}})}),Object(D.jsx)("div",{children:Object(D.jsx)(J.a,{label:"name",value:u,name:"name",onChange:function(e){return l(e.target.value)}})}),Object(D.jsx)("div",{children:Object(D.jsx)(J.a,{label:"password",type:"password",value:O,name:"password",onChange:function(e){return h(e.target.value)}})}),Object(D.jsx)("br",{}),Object(D.jsx)(F.a,{variant:"contained",type:"submit",children:"Register"})]})]})},Z=function(){return Object(D.jsx)("div",{children:Object(D.jsx)("div",{children:Object(D.jsx)(P,{})})})},$=function(e){var t=e.users,n=Object(E.h)().id,r=t.find((function(e){return e.id===n}));return Object(D.jsxs)("div",{children:[Object(D.jsx)("h2",{children:r.name}),Object(D.jsx)("ul",{children:r.blogs.map((function(e){return Object(D.jsx)("li",{children:Object(D.jsx)(S.b,{to:"/blogs/".concat(e.id),children:e.title})},e.id)}))})]})},ee=function(e){var t=e.users;return Object(D.jsxs)("div",{children:[Object(D.jsx)("h2",{children:"Users"}),Object(D.jsxs)(R.a,{children:[Object(D.jsx)(K.a,{children:Object(D.jsxs)(N.a,{children:[Object(D.jsx)(C.a,{}),Object(D.jsx)(C.a,{children:Object(D.jsx)("strong",{children:"blogs created"})})]})}),Object(D.jsx)(L.a,{children:t.map((function(e){return Object(D.jsxs)(N.a,{children:[Object(D.jsx)(C.a,{children:Object(D.jsx)(S.b,{to:"/users/".concat(e.id),children:e.name})}),Object(D.jsx)(C.a,{children:e.blogs.length})]},e.id)}))})]})]})},te=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.user})),n=Object(r.useState)([]),c=Object(s.a)(n,2),a=c[0],i=c[1];Object(r.useEffect)((function(){e(function(){var e=Object(j.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),A.getAll().then((function(e){return i(e)}))}),[]),Object(r.useEffect)((function(){var t=window.localStorage.getItem("user");if(t){var n=JSON.parse(t);e(function(e){return{type:"LOG_USER",data:e}}(n)),g.setToken(n.token)}}),[]);return Object(D.jsx)(Q.a,{children:Object(D.jsxs)(S.a,{children:[Object(D.jsx)(V.a,{position:"static",children:Object(D.jsxs)(X.a,{children:[Object(D.jsx)(F.a,{color:"inherit",component:S.b,to:"/users",children:"users"}),Object(D.jsx)(F.a,{color:"inherit",component:S.b,to:"/blogs",children:"blogs"}),Object(D.jsx)("strong",{children:t?"".concat(t.name," is logged in"):""}),t?Object(D.jsx)(F.a,{color:"inherit",onClick:function(){window.localStorage.removeItem("user"),e({type:"LOGOUT"}),g.setToken(null)},children:"logout"}):Object(D.jsx)(F.a,{color:"inherit",component:S.b,to:"/login",children:"login"}),t?"":Object(D.jsx)(F.a,{color:"inherit",component:S.b,to:"/register",children:"Register"})]})}),Object(D.jsx)(q,{}),Object(D.jsxs)(E.d,{children:[Object(D.jsx)(E.b,{path:"/users/:id",children:Object(D.jsx)($,{users:a})}),Object(D.jsx)(E.b,{path:"/users",children:t?Object(D.jsx)(ee,{users:a}):Object(D.jsx)(E.a,{to:"/login"})}),Object(D.jsx)(E.b,{path:"/blogs/:id",children:Object(D.jsx)(_,{})}),Object(D.jsxs)(E.b,{path:"/blogs",children:[t?Object(D.jsx)(B,{}):Object(D.jsx)(E.a,{to:"/login"}),t&&Object(D.jsx)(z,{buttonLabel:"blog",children:Object(D.jsx)(H,{})})]}),Object(D.jsx)(E.b,{path:"/register",children:t?Object(D.jsx)(E.a,{to:"/blogs"}):Object(D.jsx)(Y,{})}),Object(D.jsx)(E.b,{path:"/",children:t?Object(D.jsx)(E.a,{to:"/blogs"}):Object(D.jsx)(Z,{})})]})]})})},ne=n(46),re=n(67),ce=Object(ne.b)({message:I,blogs:w,user:U}),ae=Object(ne.c)(ce,Object(ne.a)(re.a));a.a.render(Object(D.jsx)(m.a,{store:ae,children:Object(D.jsx)(te,{})}),document.getElementById("root"))}},[[105,1,2]]]);
//# sourceMappingURL=main.de681ea7.chunk.js.map